FROM node:22-alpine
RUN apk add --no-cache libc6-compat bash
WORKDIR /app

COPY docker/dev-entrypoint.sh /usr/local/bin/dev-entrypoint.sh
RUN chmod +x /usr/local/bin/dev-entrypoint.sh

ENV NEXT_TELEMETRY_DISABLED=1 \
    WATCHPACK_POLLING=true \
    CHOKIDAR_USEPOLLING=true \
    CHOKIDAR_INTERVAL=300

ENTRYPOINT ["dev-entrypoint.sh"]
CMD ["npm", "run", "dev:webpack"]